<div class="section">
    <h1>Detailed Findings</h1>
    {% for finding in findings %}
    <div style="margin-bottom: 30px; border: 1px solid #ccc; padding: 15px; page-break-inside: avoid;">
        <h2 style="margin-top: 0; border-bottom: none;">{{ forloop.counter }}. {{ finding.title }}</h2>

        <table class="table" style="margin-bottom: 10px;">
            <tr>
                <th style="width: 20%;">Severity</th>
                <td class="severity-{{ finding.severity }}">{{ finding.severity }}</td>
                <th style="width: 20%;">Status</th>
                <td>{{ finding.status }}</td>
            </tr>
            <tr>
                <th>Affected Asset</th>
                <td colspan="3">{{ finding.affected|default:"-" }}</td>
            </tr>
        </table>

        <h3>Description</h3>
        <p>{{ finding.description|linebreaks }}</p>

        <h3>Impact</h3>
        <p>{{ finding.impact|linebreaks }}</p>

        <h3>Recommendation</h3>
        <p>{{ finding.recommendation|linebreaks }}</p>

        {% if finding.poc %}
        <h3>Proof of Concept (POC)</h3>
        <div
            style="background-color: #f5f5f5; padding: 10px; border: 1px solid #ddd; font-family: monospace; white-space: pre-wrap;">
            {{ finding.poc }}</div>
        {% endif %}

        {% if finding.cvss_score %}
        <p><strong>CVSS Score:</strong> {{ finding.cvss_score }}</p>
        {% endif %}
    </div>
    <hr style="border: 0; border-top: 1px dashed #ccc; margin: 20px 0;">
    {% endfor %}
</div>